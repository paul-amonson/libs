<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>PropMap.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">libs</a> &gt; <a href="index.source.html" class="el_package">com.amonson.prop_store</a> &gt; <span class="el_source">PropMap.java</span></div><h1>PropMap.java</h1><pre class="source lang-java linenums">// Copyright (C) 2018-2019 Paul Amonson
//
// SPDX-License-Identifier: Apache-2.0
//

package com.amonson.prop_store;

import java.math.BigDecimal;
import java.math.BigInteger;
import java.util.HashMap;
import java.util.Map;
import java.util.function.BiFunction;

/**
 * Class to store a dictionary of property name/value pairs.
 */
@SuppressWarnings(&quot;serial&quot;)
public class PropMap extends HashMap&lt;String, Object&gt; {
    public PropMap() {
<span class="fc" id="L20">        super();</span>
<span class="fc" id="L21">    }</span>

    public PropMap(Map&lt;String, ?&gt; map) {
<span class="nc" id="L24">        super(map);</span>
<span class="nc" id="L25">    }</span>

    public String getString(String key) {
<span class="fc" id="L28">        return getStringOrDefault(key, null);</span>
    }

    public String getStringOrDefault(String key, String defValue) {
<span class="pc bpc" id="L32" title="1 of 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="fc" id="L33">        Object obj = get(key);</span>
<span class="pc bpc" id="L34" title="1 of 2 branches missed.">        if(obj == null) return null;</span>
<span class="fc" id="L35">        return obj.toString();</span>
    }

    public PropMap getMap(String key) {
<span class="nc" id="L39">        return getMapOrDefault(key, null);</span>
    }

    public PropMap getMapOrDefault(String key, PropMap defValue) {
<span class="nc bnc" id="L43" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L44">        Object obj = get(key);</span>
<span class="nc bnc" id="L45" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L46">        return (PropMap)obj;</span>
    }

    public PropList getArray(String key) {
<span class="nc" id="L50">        return getArrayOrDefault(key, null);</span>
    }

    public PropList getArrayOrDefault(String key, PropList defValue) {
<span class="nc bnc" id="L54" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L55">        Object obj = get(key);</span>
<span class="nc bnc" id="L56" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L57">        return (PropList)obj;</span>
    }

    public Boolean getBoolean(String key) {
<span class="nc" id="L61">        return getBooleanOrDefault(key, null);</span>
    }

    public Boolean getBooleanOrDefault(String key, Boolean defValue) {
<span class="nc bnc" id="L65" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L66">        Object obj = get(key);</span>
<span class="nc bnc" id="L67" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L68">        return (Boolean)obj;</span>
    }

    public Short getShort(String key) {
<span class="nc" id="L72">        return getShortOrDefault(key, null);</span>
    }

    public Short getShortOrDefault(String key, Short defValue) {
<span class="nc bnc" id="L76" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L77">        Object obj = get(key);</span>
<span class="nc bnc" id="L78" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L79">        return ((BigDecimal)obj).shortValue();</span>
    }

    public Integer getInteger(String key) {
<span class="nc" id="L83">        return getIntegerOrDefault(key, null);</span>
    }

    public Integer getIntegerOrDefault(String key, Integer defValue) {
<span class="nc bnc" id="L87" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L88">        Object obj = get(key);</span>
<span class="nc bnc" id="L89" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L90">        return ((BigDecimal)obj).intValue();</span>
    }

    public Long getLong(String key) {
<span class="nc" id="L94">        return getLongOrDefault(key, null);</span>
    }

    public Long getLongOrDefault(String key, Long defValue) {
<span class="nc bnc" id="L98" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L99">        Object obj = get(key);</span>
<span class="nc bnc" id="L100" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L101">        return ((BigDecimal)obj).longValue();</span>
    }

    public BigInteger getBigInteger(String key) {
<span class="nc" id="L105">        return getBigIntegerOrDefault(key, null);</span>
    }

    public BigInteger getBigIntegerOrDefault(String key, BigInteger defValue) {
<span class="nc bnc" id="L109" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L110">        Object obj = get(key);</span>
<span class="nc bnc" id="L111" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L112">        return ((BigDecimal)obj).toBigInteger();</span>
    }

    public Float getFloat(String key) {
<span class="nc" id="L116">        return getFloatOrDefault(key, null);</span>
    }

    public Float getFloatOrDefault(String key, Float defValue) {
<span class="nc bnc" id="L120" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L121">        Object obj = get(key);</span>
<span class="nc bnc" id="L122" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L123">        return ((BigDecimal)obj).floatValue();</span>
    }

    public Double getDouble(String key) {
<span class="nc" id="L127">        return getDoubleOrDefault(key, null);</span>
    }

    public Double getDoubleOrDefault(String key, Double defValue) {
<span class="nc bnc" id="L131" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L132">        Object obj = get(key);</span>
<span class="nc bnc" id="L133" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L134">        return ((BigDecimal)obj).doubleValue();</span>
    }

    public BigDecimal getBigDecimal(String key) {
<span class="nc" id="L138">        return getBigDecimalOrDefault(key, null);</span>
    }

    public BigDecimal getBigDecimalOrDefault(String key, BigDecimal defValue) {
<span class="nc bnc" id="L142" title="All 2 branches missed.">        if(!containsKey(key)) return defValue;</span>
<span class="nc" id="L143">        Object obj = get(key);</span>
<span class="nc bnc" id="L144" title="All 2 branches missed.">        if(obj == null) return null;</span>
<span class="nc" id="L145">        return (BigDecimal)obj;</span>
    }

    @Override
    public Object put(String key, Object value) {
<span class="fc" id="L150">        checkKey(key);</span>
<span class="fc" id="L151">        checkType(value);</span>
<span class="fc" id="L152">        return super.put(key, makeStoredValue(value));</span>
    }

    @Override
    public void putAll(Map&lt;? extends String, ?&gt; map) {
<span class="nc bnc" id="L157" title="All 2 branches missed.">        for(String key: map.keySet())</span>
<span class="nc" id="L158">            put(key, map.get(key));</span>
<span class="nc" id="L159">    }</span>

    @Override
    public Object replace(String key, Object newValue) {
<span class="nc" id="L163">        checkKey(key);</span>
<span class="nc" id="L164">        checkType(newValue);</span>
<span class="nc" id="L165">        return super.replace(key, makeStoredValue(newValue));</span>
    }

    @Override
    public boolean replace(String key, Object oldValue, Object newValue) {
<span class="nc" id="L170">        checkKey(key);</span>
<span class="nc" id="L171">        checkType(newValue);</span>
<span class="nc" id="L172">        return super.replace(key, oldValue, makeStoredValue(newValue));</span>
    }

    @Override
    public Object merge(String key, Object value, BiFunction&lt;? super Object,? super Object,?&gt; remappingFunction) {
<span class="nc" id="L177">        throw new UnsupportedOperationException();</span>
    }

    @Override
    public void	replaceAll(BiFunction&lt;? super String,? super Object,?&gt; function) {
<span class="nc" id="L182">        throw new UnsupportedOperationException();</span>
    }

    public boolean isNull(String key) {
<span class="nc bnc" id="L186" title="All 2 branches missed.">        return get(key) == null;</span>
    }

    private void checkKey(String key) {
<span class="pc bpc" id="L190" title="1 of 2 branches missed.">        if(key.trim().equals(&quot;&quot;)) throw new IllegalArgumentException(&quot;A key in the PropMap cannot be empty!&quot;);</span>
<span class="fc" id="L191">    }</span>

    static void checkType(Object value) {
<span class="pc bpc" id="L194" title="1 of 2 branches missed.">        if(value == null) return;</span>
<span class="pc bpc" id="L195" title="9 of 10 branches missed.">        if(!(value instanceof String) &amp;&amp;</span>
                !(value instanceof PropMap) &amp;&amp;
                !(value instanceof PropList) &amp;&amp;
                !(value instanceof Number) &amp;&amp;
                !(value instanceof Boolean)) {
<span class="nc" id="L200">            throw new ClassCastException(String.format(&quot;'value' is not a supported type: %s&quot;,</span>
<span class="nc" id="L201">                    value.getClass().getCanonicalName()));</span>
        }
<span class="fc" id="L203">    }</span>

    static Object makeStoredValue(Object value) {
<span class="pc bpc" id="L206" title="6 of 12 branches missed.">        if(value instanceof Float || value instanceof Double || value instanceof Short || value instanceof Integer ||</span>
                value instanceof Long || value instanceof BigInteger)
<span class="nc" id="L208">            return new BigDecimal(value.toString());</span>
<span class="fc" id="L209">        return value;</span>
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>